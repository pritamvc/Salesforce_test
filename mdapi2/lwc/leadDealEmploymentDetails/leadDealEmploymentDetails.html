<!--
  @description       : 
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             : 
  @last modified on  : 07-25-2023
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
-->
<template>
    <div class="spinner">
        <template if:true={isLoading}>
            <lightning-spinner alternative-text="Loading" variant="brand" size="large">
            </lightning-spinner>
        </template>
    </div>
    <div class={sectionClass}>
        <lightning-accordion allow-multiple-sections-open active-section-name="Employment" class="title1">
            <lightning-accordion-section class="slds-col slds-size_4-of-4 slds-p-around_small" name="Employment"
                label="Employment">
                <table class="slds-table slds-no-row-hover slds-table_cell-buffer" role="grid">
                    <tbody>
                        <template for:each={listOfEmploymentTable} for:item="rec">
                            <tr key={rec.objEmployment}>
                                <td>
                                    <lightning-combobox name="applicantNamesEmployment" label="Applicant Name"
                                        data-id={rec.objEmployment.Id} value={rec.objEmployment.Account__c}
                                        options={TypeOptions} onchange={handleTypeChange} required="true">
                                    </lightning-combobox>

                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <td>
                                    <template if:true={EmploymentTypePerAccOptions.data}>
                                        <lightning-combobox variant="label-standard" label="Employment Type"
                                            data-id={rec.objEmployment.Id} data-name="employmenttype"
                                            name="Employment_Type__c" options={EmploymentTypePerAccOptions.data.values}
                                            value={rec.objEmployment.Employment_Type__c} required="true"
                                            class="dropdown" onchange={handleEmploymentTypeSelect}>
                                        </lightning-combobox>
                                    </template>

                                </td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypesalraiedtrue}>
                                    <td>
                                        <lightning-input label="Name of the Company" name="Name_Of_The_Company__c"
                                            value={rec.objEmployment.Name_Of_The_Company__c} type="text"
                                            data-id={rec.objEmployment.Id} 
                                            onchange={handleChangeEmployment} required="true">
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <template if:true={TypeOfCompanyPerAccOptions.data}>
                                            <lightning-combobox variant="label-standard" label="Type of Company"
                                                data-id={rec.objEmployment.Id} name="Type_Of_Company__c"
                                                options={TypeOfCompanyPerAccOptions.data.values}
                                                value={rec.objEmployment.Type_Of_Company__c} required="true"
                                                onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <template if:true={rec.finalDependentVal}>
                                            <lightning-combobox variant="label-standard" label="Sector"
                                                data-id={rec.objEmployment.Id} name="Sector__c"
                                                options={rec.finalDependentVal} value={rec.objEmployment.Sector__c}
                                                required="true" onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <template if:true={RoleInOrgPerAccOptions.data}>
                                            <lightning-combobox variant="label-standard" label="Designation"
                                                data-id={rec.objEmployment.Id} name="Role_In_Organization__c"
                                                options={RoleInOrgPerAccOptions.data.values}
                                                value={rec.objEmployment.Role_In_Organization__c} required="true"
                                                onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                </template>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypesalraiedtrue}>
                                    <td>
                                        <lightning-input label="Official Email Id" name="Official_Email_Id__c"
                                            value={rec.objEmployment.Official_Email_Id__c}
                                            placeholder="username@example.com"
                                            pattern="[A-Za-z0-9._-]+@[a-z0-9]+\.[a-z]{2,}$"
                                            message-when-pattern-mismatch="Please enter valid Email id" type="email"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Gross Monthly Income" name="Monthly_Income__c"
                                            value={rec.objEmployment.Monthly_Income__c} type="number"
                                            data-id={rec.objEmployment.Id} pattern="^[1-9][0-9]{0,5}$" required="true"
                                            message-when-pattern-mismatch="Please enter a valid income"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="No. of Years with Current Employer"
                                            name="No_Of_Years_with_Current_Employer__c"
                                            value={rec.objEmployment.No_of_Years_with_Current_Employer__c} type="number"
                                            data-id={rec.objEmployment.Id} required="true" pattern="^[0-9]{0,2}$"
                                            message-when-pattern-mismatch="Please enter a valid experience"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Total Professional Experience"
                                            name="Total_Professional_Experience__c"
                                            value={rec.objEmployment.Total_Professional_Experience__c} type="number"
                                            data-id={rec.objEmployment.Id} required="true" pattern="^[0-9]{0,2}$"
                                            message-when-pattern-mismatch="Please enter a valid experience"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td></td>
                                </template>
                            </tr>

                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypeSEProfessional}>
                                    <td>
                                        <lightning-input label="Name of the Profession" name="Organisation_Name__c"
                                            value={rec.objEmployment.Organisation_Name__c} type="text"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <template if:true={TypeOfCompanyPerAccOptions.data}>
                                            <lightning-combobox variant="label-standard" label="Type of Company"
                                                data-id={rec.objEmployment.Id} name="Type_Of_Company__c"
                                                options={TypeOfCompanyPerAccOptions.data.values}
                                                value={rec.objEmployment.Type_Of_Company__c} required="true"
                                                onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <template if:true={rec.finalDependentVal}>
                                            <lightning-combobox variant="label-standard" label="Sector"
                                                data-id={rec.objEmployment.Id} name="Sector__c"
                                                options={rec.finalDependentVal} value={rec.objEmployment.Sector__c}
                                                required="true" onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <template if:true={NatureofProfessionEmpOptions.data}>
                                            <lightning-combobox variant="label-standard" label="Nature of Profession"
                                                data-id={rec.objEmployment.Id} name="NatureofProfession__c"
                                                options={NatureofProfessionEmpOptions.data.values}
                                                value={rec.objEmployment.NatureofProfession__c}
                                                onchange={handleChangeEmployment} required="true">
                                            </lightning-combobox>
                                        </template>
                                    </td>                                    
                                </template>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypeSEProfessional}>
                                    <td>
                                        <lightning-input label="Gross Monthly Income" name="Monthly_Income__c"
                                            value={rec.objEmployment.Monthly_Income__c} type="number"
                                            data-id={rec.objEmployment.Id} pattern="^[1-9][0-9]{0,5}$" required="true"
                                            message-when-pattern-mismatch="Please enter a valid income"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="No. of years in Current Profession"
                                            name="No_Of_Years_with_Current_Employer__c"
                                            value={rec.objEmployment.No_of_Years_with_Current_Employer__c} type="number"
                                            data-id={rec.objEmployment.Id} required="true" pattern="^[0-9]{0,2}$"
                                            message-when-pattern-mismatch="Please enter a valid experience"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Total Professional Experience"
                                            name="Total_Professional_Experience__c"
                                            value={rec.objEmployment.Total_Professional_Experience__c} type="number"
                                            data-id={rec.objEmployment.Id} required="true" pattern="^[0-9]{0,2}$"
                                            message-when-pattern-mismatch="Please enter a valid experience"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Membership Number" name="Membership_Number__c"
                                            value={rec.objEmployment.Membership_Number__c} type="text"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>                                    
                                </template>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypeSEProfessional}>
                                    <td>
                                        <lightning-input label="GST In" name="GST_IN__c"
                                            value={rec.objEmployment.GST_IN__c} type="text"
                                            pattern="^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[0-9A-Z]{1}[Z]{1}[0-9A-Z]{1}$"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}
                                            message-when-pattern-mismatch="Please enter valid GST In">
                                        </lightning-input>
                                    </td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </template>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypeSENonProfessional}>
                                    <td>
                                        <lightning-input label="Name of the Entity" name="Organisation_Name__c"
                                            value={rec.objEmployment.Organisation_Name__c} type="text"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>                                  
                                    <td>
                                        <template if:true={TypeOfCompanyPerAccOptions.data}>
                                            <lightning-combobox variant="label-standard" label="Type of Company"
                                                data-id={rec.objEmployment.Id} name="Type_Of_Company__c"
                                                options={TypeOfCompanyPerAccOptions.data.values}
                                                value={rec.objEmployment.Type_Of_Company__c} required="true"
                                                onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <template if:true={rec.finalDependentVal}>
                                            <lightning-combobox variant="label-standard" label="Sector"
                                                data-id={rec.objEmployment.Id} name="Sector__c"
                                                options={rec.finalDependentVal} value={rec.objEmployment.Sector__c}
                                                required="true" onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <template if:true={rec.finalDependentValNOB}>
                                            <lightning-combobox variant="label-standard" label="Nature of Business"
                                                data-id={rec.objEmployment.Id} name="NatureofBusiness__c"
                                                options={rec.finalDependentValNOB}
                                                value={rec.objEmployment.NatureofBusiness__c}
                                                onchange={handleChangeEmployment} required="true">
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                </template>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypeSENonProfessional}>
                                    <td>
                                        <lightning-input label="Gross Monthly Income" name="Monthly_Income__c"
                                            value={rec.objEmployment.Monthly_Income__c} type="number"
                                            data-id={rec.objEmployment.Id} pattern="^[1-9][0-9]{0,5}$" required="true"
                                            message-when-pattern-mismatch="Please enter a valid income"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="No. of years in Current Business"
                                            name="No_Of_Years_with_Current_Employer__c"
                                            value={rec.objEmployment.No_of_Years_with_Current_Employer__c} type="number"
                                            data-id={rec.objEmployment.Id} required="true" pattern="^[0-9]{0,2}$"
                                            message-when-pattern-mismatch="Please enter a valid experience"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Total Professional Experience"
                                            name="Total_Professional_Experience__c"
                                            value={rec.objEmployment.Total_Professional_Experience__c} type="number"
                                            data-id={rec.objEmployment.Id} required="true" pattern="^[0-9]{0,2}$"
                                            message-when-pattern-mismatch="Please enter a valid experience"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Membership Number" name="Membership_Number__c"
                                            value={rec.objEmployment.Membership_Number__c} type="text"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>                                    
                                </template>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypeSENonProfessional}>
                                    <td>
                                        <lightning-input label="GST In" name="GST_IN__c"
                                            pattern="^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[0-9A-Z]{1}[Z]{1}[0-9A-Z]{1}$"
                                            value={rec.objEmployment.GST_IN__c} type="text"
                                            message-when-pattern-mismatch="Please enter valid GST In"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </template>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypeRetired}>
                                    <td>
                                        <lightning-input label="Name of the Last Employer
                                        " name="Organisation_Name__c"
                                            value={rec.objEmployment.Organisation_Name__c} type="text"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <template if:true={TypeOfCompanyPerAccOptions.data}>
                                            <lightning-combobox variant="label-standard" label="Type of Company"
                                                data-id={rec.objEmployment.Id} name="Type_Of_Company__c"
                                                options={TypeOfCompanyPerAccOptions.data.values}
                                                value={rec.objEmployment.Type_Of_Company__c} required="true"
                                                onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <template if:true={rec.finalDependentVal}>
                                            <lightning-combobox variant="label-standard" label="Sector"
                                                data-id={rec.objEmployment.Id} name="Sector__c"
                                                options={rec.finalDependentVal} value={rec.objEmployment.Sector__c}
                                                required="true" onchange={handleChangeEmployment}>
                                            </lightning-combobox>
                                        </template>
                                    </td>
                                    <td>
                                        <lightning-input label="Pension Amount" name="Pension_Amount__c"
                                            value={rec.objEmployment.Pension_Amount__c} type="number"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                </template>
                            </tr>
                            <tr key={rec.objEmployment}>
                                <template if:true={rec.emptypeRetired}>
                                    <td>
                                        <lightning-input label="Date of Retirement" name="Date_of_Retirement__c"
                                            value={rec.objEmployment.Date_of_Retirement__c} type="date"
                                            data-id={rec.objEmployment.Id} onchange={handleChangeEmployment}
                                            max={todaysDate}>
                                        </lightning-input>
                                    </td>  
                                    <td>
                                        <lightning-input label="Gross Monthly Income" name="Monthly_Income__c"
                                            value={rec.objEmployment.Monthly_Income__c} type="number"
                                            data-id={rec.objEmployment.Id} pattern="^[1-9][0-9]{0,5}$" required="true"
                                            message-when-pattern-mismatch="Please enter a valid income"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="No. of years in Last Service"
                                            name="No_Of_Years_with_Current_Employer__c"
                                            value={rec.objEmployment.No_of_Years_with_Current_Employer__c} type="number"
                                            data-id={rec.objEmployment.Id} required="true" pattern="^[0-9]{0,2}$"
                                            message-when-pattern-mismatch="Please enter a valid experience"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Total Professional Experience"
                                            name="Total_Professional_Experience__c"
                                            value={rec.objEmployment.Total_Professional_Experience__c} type="number"
                                            data-id={rec.objEmployment.Id} required="true" pattern="^[0-9]{0,2}$"
                                            message-when-pattern-mismatch="Please enter a valid experience"
                                            onchange={handleChangeEmployment}>
                                        </lightning-input>
                                    </td>        
                                </template>
                            </tr>

                            <!-- Address Details -->


                            <tr key={rec.appOfficeAdd}>
                                <template if:true={rec.ShowAddressSection}>
                                    <td colspan="4">
                                        <div class="title-heading">Address Details</div>
                                    </td>
                                </template>
                            </tr>



                            <tr key={rec.appOfficeAdd}>
                                <template if:true={rec.ShowAddressSection}>
                                    <td>
                                        <lightning-input label="Office Address" name="Address_1__c"
                                            value={rec.appOfficeAdd.Address_1__c} type="text"
                                            data-id={rec.appOfficeAdd.Id} onchange={handleChangeAddress} required>
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-record-edit-form object-api-name="ContactPointAddress">
                                            <label class="slds-form-element__label" for="pinCode">Pin Code<span
                                                    class="slds-required">*</span></label>
                                            <div class="slds-form-element__control">
                                                <lightning-input-field field-name="Pin_Code__c" variant="label-hidden"
                                                    value={rec.appOfficeAdd.Pin_Code__c} name="Pin_Code__c"
                                                    onchange={handleRefPincode} data-id={rec.appOfficeAdd.Id} required>
                                                </lightning-input-field>
                                            </div>
                                        </lightning-record-edit-form>
                                    </td>
                                    <td>
                                        <lightning-input label="City" name="City__c" value={rec.appOfficeAdd.City__c}
                                            type="text" data-id={rec.appOfficeAdd.Id} onchange={handleChangeAddress}
                                            disabled="true">
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="District/Taluka" name="District__c"
                                            value={rec.appOfficeAdd.District__c} type="text"
                                            data-id={rec.appOfficeAdd.Id} onchange={handleChangeAddress}
                                            disabled="true">
                                        </lightning-input>
                                    </td>
                                </template>
                            </tr>

                            <tr key={rec.appOfficeAdd}>
                                <template if:true={rec.ShowAddressSection}>
                                    <td>
                                        <lightning-input label="State" name="State__c" value={rec.appOfficeAdd.State__c}
                                            type="text" data-id={rec.appOfficeAdd.Id} onchange={handleChangeAddress}
                                            disabled="true">
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Country" name="Country__c"
                                            value={rec.appOfficeAdd.Country__c} type="text"
                                            data-id={rec.appOfficeAdd.Id} onchange={handleChangeAddress}
                                            disabled="true">
                                        </lightning-input>
                                    </td>
                                    <td>
                                        <lightning-input label="Landmark" name="Landmark__c"
                                            value={rec.appOfficeAdd.Landmark__c} type="text"
                                            data-id={rec.appOfficeAdd.Id} onchange={handleChangeAddress}>
                                        </lightning-input>
                                    </td>
                                    <td></td>
                                </template>
                            </tr>


                            <!-- Add / Delete Buttons -->
                            <tr key={rec}>
                                <td>
                                    <lightning-icon icon-name="utility:add" size="small" title="Add Row"
                                        alternative-text="Add Row"
                                        onclick={addNewRowEmployment}></lightning-icon>&nbsp;&nbsp;&nbsp;
                                    <lightning-icon icon-name="utility:delete" size="small" alternative-text="Remove"
                                        title="Remove" name={rec.index} data-id={rec.objEmployment.Id}
                                        onclick={removeTheRowEmployment}></lightning-icon>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </lightning-accordion-section>

            <br><br><lightning-card>
                <lightning-layout multiple-rows horizontal-align="center">
                    <lightning-layout-item>
                        <lightning-button class="button slds-align_absolute-center" style="width: fit-content;"
                            label="Save as draft" variant="brand" onclick={handleSaveEmployment}>
                        </lightning-button>
                    </lightning-layout-item>
                    <lightning-layout-item size="auto">
                        <div style="margin-left: 10px;">
                            <lightning-button class="button slds-align_absolute-center" style="width: fit-content;"
                                label="Save and Next" variant="brand" onclick={handleNextEmployment}>
                            </lightning-button>
                        </div>
                    </lightning-layout-item>
                </lightning-layout>
            </lightning-card>

        </lightning-accordion>
    </div>
</template>